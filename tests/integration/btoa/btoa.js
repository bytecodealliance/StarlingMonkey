import { serveTest } from '../test-server.js';
import { strictEqual, throws } from '../../assert.js';

export const handler = serveTest(async (t) => {
  t.test('btoa', () => {
    var everything = "";
    for (var i = 0; i < 256; i++) {
      everything += String.fromCharCode(i);
    }
    strictEqual(btoa(everything), 'AAECAwQFBgcICQoLDA0ODxAREhMUFRYXGBkaGxwdHh8gISIjJCUmJygpKissLS4vMDEyMzQ1Njc4OTo7PD0+P0BBQkNERUZHSElKS0xNTk9QUVJTVFVWV1hZWltcXV5fYGFiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6e3x9fn+AgYKDhIWGh4iJiouMjY6PkJGSk5SVlpeYmZqbnJ2en6ChoqOkpaanqKmqq6ytrq+wsbKztLW2t7i5uru8vb6/wMHCw8TFxsfIycrLzM3Oz9DR0tPU1dbX2Nna29zd3t/g4eLj5OXm5+jp6uvs7e7v8PHy8/T19vf4+fr7/P3+/w==');

    strictEqual(btoa(42), btoa('42'));
    strictEqual(btoa(null), btoa('null'));
    strictEqual(btoa({ x: 1 }), btoa('[object Object]'));

    throws(() => btoa(), TypeError);
    throws(() => btoa('üê±'));

    strictEqual(btoa(""), "", `btoa("")`);
    strictEqual(btoa("ab"), "YWI=", `btoa("ab")`);
    strictEqual(btoa("abc"), "YWJj", `btoa("abc")`);
    strictEqual(btoa("abcd"), "YWJjZA==", `btoa("abcd")`);
    strictEqual(btoa("abcde"), "YWJjZGU=", `btoa("abcde")`);
    strictEqual(btoa("√ø√ø√Ä"), "///A", `btoa("√ø√ø√Ä")`);
    strictEqual(btoa("\0a"), "AGE=", `btoa("\\0a")`);
    strictEqual(btoa("a\0b"), "YQBi", `btoa("a\\0b")`);
    strictEqual(btoa(undefined), "dW5kZWZpbmVk", `btoa(undefined)`);
    strictEqual(btoa(null), "bnVsbA==", `btoa(null)`);
    strictEqual(btoa(7), "Nw==", `btoa(7)`);
    strictEqual(btoa(12), "MTI=", `btoa(12)`);
    strictEqual(btoa(1.5), "MS41", `btoa(1.5)`);
    strictEqual(btoa(true), "dHJ1ZQ==", `btoa(true)`);
    strictEqual(btoa(false), "ZmFsc2U=", `btoa(false)`);
    strictEqual(btoa(NaN), "TmFO", `btoa(NaN)`);
    strictEqual(btoa(Infinity), "SW5maW5pdHk=", `btoa(Infinity)`);
    strictEqual(btoa(-Infinity), "LUluZmluaXR5", `btoa(-Infinity)`);
    strictEqual(btoa(0), "MA==", `btoa(0)`);
    strictEqual(btoa(-0), "MA==", `btoa(-0)`);
    strictEqual(btoa("\0"), "AA==", `btoa("\\0")`);
    strictEqual(btoa("\x01"), "AQ==", `btoa("\\x01")`);
    strictEqual(btoa("\x02"), "Ag==", `btoa("\\x02")`);
    strictEqual(btoa("\x03"), "Aw==", `btoa("\\x03")`);
    strictEqual(btoa("\x04"), "BA==", `btoa("\\x04")`);
    strictEqual(btoa("\x05"), "BQ==", `btoa("\\x05")`);
    strictEqual(btoa("\x06"), "Bg==", `btoa("\\x06")`);
    strictEqual(btoa("\x07"), "Bw==", `btoa("\\x07")`);
    strictEqual(btoa("\b"), "CA==", `btoa("\\b")`);
    strictEqual(btoa("\t"), "CQ==", `btoa("\\t")`);
    strictEqual(btoa("\n"), "Cg==", `btoa("\\n")`);
    strictEqual(btoa("\v"), "Cw==", `btoa("\\v")`);
    strictEqual(btoa("\f"), "DA==", `btoa("\\f")`);
    strictEqual(btoa("\r"), "DQ==", `btoa("\\r")`);
    strictEqual(btoa("\x0e"), "Dg==", `btoa("\\x0e")`);
    strictEqual(btoa("\x0f"), "Dw==", `btoa("\\x0f")`);
    strictEqual(btoa("\x10"), "EA==", `btoa("\\x10")`);
    strictEqual(btoa("\x11"), "EQ==", `btoa("\\x11")`);
    strictEqual(btoa("\x12"), "Eg==", `btoa("\\x12")`);
    strictEqual(btoa("\x13"), "Ew==", `btoa("\\x13")`);
    strictEqual(btoa("\x14"), "FA==", `btoa("\\x14")`);
    strictEqual(btoa("\x15"), "FQ==", `btoa("\\x15")`);
    strictEqual(btoa("\x16"), "Fg==", `btoa("\\x16")`);
    strictEqual(btoa("\x17"), "Fw==", `btoa("\\x17")`);
    strictEqual(btoa("\x18"), "GA==", `btoa("\\x18")`);
    strictEqual(btoa("\x19"), "GQ==", `btoa("\\x19")`);
    strictEqual(btoa("\x1a"), "Gg==", `btoa("\\x1a")`);
    strictEqual(btoa("\x1b"), "Gw==", `btoa("\\x1b")`);
    strictEqual(btoa("\x1c"), "HA==", `btoa("\\x1c")`);
    strictEqual(btoa("\x1d"), "HQ==", `btoa("\\x1d")`);
    strictEqual(btoa("\x1e"), "Hg==", `btoa("\\x1e")`);
    strictEqual(btoa("\x1f"), "Hw==", `btoa("\\x1f")`);
    strictEqual(btoa(" "), "IA==", `btoa(" ")`);
    strictEqual(btoa("!"), "IQ==", `btoa("!")`);
    strictEqual(btoa("#"), "Iw==", `btoa("#")`);
    strictEqual(btoa("$"), "JA==", `btoa("$")`);
    strictEqual(btoa("%"), "JQ==", `btoa("%")`);
    strictEqual(btoa("&"), "Jg==", `btoa("&")`);
    strictEqual(btoa("'"), "Jw==", `btoa("'")`);
    strictEqual(btoa("("), "KA==", `btoa("(")`);
    strictEqual(btoa(")"), "KQ==", `btoa(")")`);
    strictEqual(btoa("*"), "Kg==", `btoa("*")`);
    strictEqual(btoa("+"), "Kw==", `btoa("+")`);
    strictEqual(btoa(","), "LA==", `btoa(",")`);
    strictEqual(btoa("-"), "LQ==", `btoa("-")`);
    strictEqual(btoa("."), "Lg==", `btoa(".")`);
    strictEqual(btoa("/"), "Lw==", `btoa("/")`);
    strictEqual(btoa("0"), "MA==", `btoa("0")`);
    strictEqual(btoa("1"), "MQ==", `btoa("1")`);
    strictEqual(btoa("2"), "Mg==", `btoa("2")`);
    strictEqual(btoa("3"), "Mw==", `btoa("3")`);
    strictEqual(btoa("4"), "NA==", `btoa("4")`);
    strictEqual(btoa("5"), "NQ==", `btoa("5")`);
    strictEqual(btoa("6"), "Ng==", `btoa("6")`);
    strictEqual(btoa("7"), "Nw==", `btoa("7")`);
    strictEqual(btoa("8"), "OA==", `btoa("8")`);
    strictEqual(btoa("9"), "OQ==", `btoa("9")`);
    strictEqual(btoa(":"), "Og==", `btoa(":")`);
    strictEqual(btoa(";"), "Ow==", `btoa(";")`);
    strictEqual(btoa("<"), "PA==", `btoa("<")`);
    strictEqual(btoa("="), "PQ==", `btoa("=")`);
    strictEqual(btoa(">"), "Pg==", `btoa(">")`);
    strictEqual(btoa("?"), "Pw==", `btoa("?")`);
    strictEqual(btoa("@"), "QA==", `btoa("@")`);
    strictEqual(btoa("A"), "QQ==", `btoa("A")`);
    strictEqual(btoa("B"), "Qg==", `btoa("B")`);
    strictEqual(btoa("C"), "Qw==", `btoa("C")`);
    strictEqual(btoa("D"), "RA==", `btoa("D")`);
    strictEqual(btoa("E"), "RQ==", `btoa("E")`);
    strictEqual(btoa("F"), "Rg==", `btoa("F")`);
    strictEqual(btoa("G"), "Rw==", `btoa("G")`);
    strictEqual(btoa("H"), "SA==", `btoa("H")`);
    strictEqual(btoa("I"), "SQ==", `btoa("I")`);
    strictEqual(btoa("J"), "Sg==", `btoa("J")`);
    strictEqual(btoa("K"), "Sw==", `btoa("K")`);
    strictEqual(btoa("L"), "TA==", `btoa("L")`);
    strictEqual(btoa("M"), "TQ==", `btoa("M")`);
    strictEqual(btoa("N"), "Tg==", `btoa("N")`);
    strictEqual(btoa("O"), "Tw==", `btoa("O")`);
    strictEqual(btoa("P"), "UA==", `btoa("P")`);
    strictEqual(btoa("Q"), "UQ==", `btoa("Q")`);
    strictEqual(btoa("R"), "Ug==", `btoa("R")`);
    strictEqual(btoa("S"), "Uw==", `btoa("S")`);
    strictEqual(btoa("T"), "VA==", `btoa("T")`);
    strictEqual(btoa("U"), "VQ==", `btoa("U")`);
    strictEqual(btoa("V"), "Vg==", `btoa("V")`);
    strictEqual(btoa("W"), "Vw==", `btoa("W")`);
    strictEqual(btoa("X"), "WA==", `btoa("X")`);
    strictEqual(btoa("Y"), "WQ==", `btoa("Y")`);
    strictEqual(btoa("Z"), "Wg==", `btoa("Z")`);
    strictEqual(btoa("["), "Ww==", `btoa("[")`);
    strictEqual(btoa("\\"), "XA==", `btoa("\\\\")`);
    strictEqual(btoa("]"), "XQ==", `btoa("]")`);
    strictEqual(btoa("^"), "Xg==", `btoa("^")`);
    strictEqual(btoa("_"), "Xw==", `btoa("_")`);
    strictEqual(btoa("a"), "YQ==", `btoa("a")`);
    strictEqual(btoa("b"), "Yg==", `btoa("b")`);
    strictEqual(btoa("c"), "Yw==", `btoa("c")`);
    strictEqual(btoa("d"), "ZA==", `btoa("d")`);
    strictEqual(btoa("e"), "ZQ==", `btoa("e")`);
    strictEqual(btoa("f"), "Zg==", `btoa("f")`);
    strictEqual(btoa("g"), "Zw==", `btoa("g")`);
    strictEqual(btoa("h"), "aA==", `btoa("h")`);
    strictEqual(btoa("i"), "aQ==", `btoa("i")`);
    strictEqual(btoa("j"), "ag==", `btoa("j")`);
    strictEqual(btoa("k"), "aw==", `btoa("k")`);
    strictEqual(btoa("l"), "bA==", `btoa("l")`);
    strictEqual(btoa("m"), "bQ==", `btoa("m")`);
    strictEqual(btoa("n"), "bg==", `btoa("n")`);
    strictEqual(btoa("o"), "bw==", `btoa("o")`);
    strictEqual(btoa("p"), "cA==", `btoa("p")`);
    strictEqual(btoa("q"), "cQ==", `btoa("q")`);
    strictEqual(btoa("r"), "cg==", `btoa("r")`);
    strictEqual(btoa("s"), "cw==", `btoa("s")`);
    strictEqual(btoa("t"), "dA==", `btoa("t")`);
    strictEqual(btoa("u"), "dQ==", `btoa("u")`);
    strictEqual(btoa("v"), "dg==", `btoa("v")`);
    strictEqual(btoa("w"), "dw==", `btoa("w")`);
    strictEqual(btoa("x"), "eA==", `btoa("x")`);
    strictEqual(btoa("y"), "eQ==", `btoa("y")`);
    strictEqual(btoa("z"), "eg==", `btoa("z")`);
    strictEqual(btoa("{"), "ew==", `btoa("{")`);
    strictEqual(btoa("|"), "fA==", `btoa("|")`);
    strictEqual(btoa("}"), "fQ==", `btoa("}")`);
    strictEqual(btoa("~"), "fg==", `btoa("~")`);
    strictEqual(btoa(""), "fw==", `btoa("")`);
    strictEqual(btoa("¬Ä"), "gA==", `btoa("¬Ä")`);
    strictEqual(btoa("¬Å"), "gQ==", `btoa("¬Å")`);
    strictEqual(btoa("¬Ç"), "gg==", `btoa("¬Ç")`);
    strictEqual(btoa("¬É"), "gw==", `btoa("¬É")`);
    strictEqual(btoa("¬Ñ"), "hA==", `btoa("¬Ñ")`);
    strictEqual(btoa("¬Ö"), "hQ==", `btoa("¬Ö")`);
    strictEqual(btoa("¬Ü"), "hg==", `btoa("¬Ü")`);
    strictEqual(btoa("¬á"), "hw==", `btoa("¬á")`);
    strictEqual(btoa("¬à"), "iA==", `btoa("¬à")`);
    strictEqual(btoa("¬â"), "iQ==", `btoa("¬â")`);
    strictEqual(btoa("¬ä"), "ig==", `btoa("¬ä")`);
    strictEqual(btoa("¬ã"), "iw==", `btoa("¬ã")`);
    strictEqual(btoa("¬å"), "jA==", `btoa("¬å")`);
    strictEqual(btoa("¬ç"), "jQ==", `btoa("¬ç")`);
    strictEqual(btoa("¬é"), "jg==", `btoa("¬é")`);
    strictEqual(btoa("¬è"), "jw==", `btoa("¬è")`);
    strictEqual(btoa("¬ê"), "kA==", `btoa("¬ê")`);
    strictEqual(btoa("¬ë"), "kQ==", `btoa("¬ë")`);
    strictEqual(btoa("¬í"), "kg==", `btoa("¬í")`);
    strictEqual(btoa("¬ì"), "kw==", `btoa("¬ì")`);
    strictEqual(btoa("¬î"), "lA==", `btoa("¬î")`);
    strictEqual(btoa("¬ï"), "lQ==", `btoa("¬ï")`);
    strictEqual(btoa("¬ñ"), "lg==", `btoa("¬ñ")`);
    strictEqual(btoa("¬ó"), "lw==", `btoa("¬ó")`);
    strictEqual(btoa("¬ò"), "mA==", `btoa("¬ò")`);
    strictEqual(btoa("¬ô"), "mQ==", `btoa("¬ô")`);
    strictEqual(btoa("¬ö"), "mg==", `btoa("¬ö")`);
    strictEqual(btoa("¬õ"), "mw==", `btoa("¬õ")`);
    strictEqual(btoa("¬ú"), "nA==", `btoa("¬ú")`);
    strictEqual(btoa("¬ù"), "nQ==", `btoa("¬ù")`);
    strictEqual(btoa("¬û"), "ng==", `btoa("¬û")`);
    strictEqual(btoa("¬ü"), "nw==", `btoa("¬ü")`);
    strictEqual(btoa("¬†"), "oA==", `btoa("¬†")`);
    strictEqual(btoa("¬°"), "oQ==", `btoa("¬°")`);
    strictEqual(btoa("¬¢"), "og==", `btoa("¬¢")`);
    strictEqual(btoa("¬£"), "ow==", `btoa("¬£")`);
    strictEqual(btoa("¬§"), "pA==", `btoa("¬§")`);
    strictEqual(btoa("¬•"), "pQ==", `btoa("¬•")`);
    strictEqual(btoa("¬¶"), "pg==", `btoa("¬¶")`);
    strictEqual(btoa("¬ß"), "pw==", `btoa("¬ß")`);
    strictEqual(btoa("¬®"), "qA==", `btoa("¬®")`);
    strictEqual(btoa("¬©"), "qQ==", `btoa("¬©")`);
    strictEqual(btoa("¬™"), "qg==", `btoa("¬™")`);
    strictEqual(btoa("¬´"), "qw==", `btoa("¬´")`);
    strictEqual(btoa("¬¨"), "rA==", `btoa("¬¨")`);
    strictEqual(btoa("¬≠"), "rQ==", `btoa("¬≠")`);
    strictEqual(btoa("¬Æ"), "rg==", `btoa("¬Æ")`);
    strictEqual(btoa("¬Ø"), "rw==", `btoa("¬Ø")`);
    strictEqual(btoa("¬∞"), "sA==", `btoa("¬∞")`);
    strictEqual(btoa("¬±"), "sQ==", `btoa("¬±")`);
    strictEqual(btoa("¬≤"), "sg==", `btoa("¬≤")`);
    strictEqual(btoa("¬≥"), "sw==", `btoa("¬≥")`);
    strictEqual(btoa("¬¥"), "tA==", `btoa("¬¥")`);
    strictEqual(btoa("¬µ"), "tQ==", `btoa("¬µ")`);
    strictEqual(btoa("¬∂"), "tg==", `btoa("¬∂")`);
    strictEqual(btoa("¬∑"), "tw==", `btoa("¬∑")`);
    strictEqual(btoa("¬∏"), "uA==", `btoa("¬∏")`);
    strictEqual(btoa("¬π"), "uQ==", `btoa("¬π")`);
    strictEqual(btoa("¬∫"), "ug==", `btoa("¬∫")`);
    strictEqual(btoa("¬ª"), "uw==", `btoa("¬ª")`);
    strictEqual(btoa("¬º"), "vA==", `btoa("¬º")`);
    strictEqual(btoa("¬Ω"), "vQ==", `btoa("¬Ω")`);
    strictEqual(btoa("¬æ"), "vg==", `btoa("¬æ")`);
    strictEqual(btoa("¬ø"), "vw==", `btoa("¬ø")`);
    strictEqual(btoa("√Ä"), "wA==", `btoa("√Ä")`);
    strictEqual(btoa("√Å"), "wQ==", `btoa("√Å")`);
    strictEqual(btoa("√Ç"), "wg==", `btoa("√Ç")`);
    strictEqual(btoa("√É"), "ww==", `btoa("√É")`);
    strictEqual(btoa("√Ñ"), "xA==", `btoa("√Ñ")`);
    strictEqual(btoa("√Ö"), "xQ==", `btoa("√Ö")`);
    strictEqual(btoa("√Ü"), "xg==", `btoa("√Ü")`);
    strictEqual(btoa("√á"), "xw==", `btoa("√á")`);
    strictEqual(btoa("√à"), "yA==", `btoa("√à")`);
    strictEqual(btoa("√â"), "yQ==", `btoa("√â")`);
    strictEqual(btoa("√ä"), "yg==", `btoa("√ä")`);
    strictEqual(btoa("√ã"), "yw==", `btoa("√ã")`);
    strictEqual(btoa("√å"), "zA==", `btoa("√å")`);
    strictEqual(btoa("√ç"), "zQ==", `btoa("√ç")`);
    strictEqual(btoa("√é"), "zg==", `btoa("√é")`);
    strictEqual(btoa("√è"), "zw==", `btoa("√è")`);
    strictEqual(btoa("√ê"), "0A==", `btoa("√ê")`);
    strictEqual(btoa("√ë"), "0Q==", `btoa("√ë")`);
    strictEqual(btoa("√í"), "0g==", `btoa("√í")`);
    strictEqual(btoa("√ì"), "0w==", `btoa("√ì")`);
    strictEqual(btoa("√î"), "1A==", `btoa("√î")`);
    strictEqual(btoa("√ï"), "1Q==", `btoa("√ï")`);
    strictEqual(btoa("√ñ"), "1g==", `btoa("√ñ")`);
    strictEqual(btoa("√ó"), "1w==", `btoa("√ó")`);
    strictEqual(btoa("√ò"), "2A==", `btoa("√ò")`);
    strictEqual(btoa("√ô"), "2Q==", `btoa("√ô")`);
    strictEqual(btoa("√ö"), "2g==", `btoa("√ö")`);
    strictEqual(btoa("√õ"), "2w==", `btoa("√õ")`);
    strictEqual(btoa("√ú"), "3A==", `btoa("√ú")`);
    strictEqual(btoa("√ù"), "3Q==", `btoa("√ù")`);
    strictEqual(btoa("√û"), "3g==", `btoa("√û")`);
    strictEqual(btoa("√ü"), "3w==", `btoa("√ü")`);
    strictEqual(btoa("√†"), "4A==", `btoa("√†")`);
    strictEqual(btoa("√°"), "4Q==", `btoa("√°")`);
    strictEqual(btoa("√¢"), "4g==", `btoa("√¢")`);
    strictEqual(btoa("√£"), "4w==", `btoa("√£")`);
    strictEqual(btoa("√§"), "5A==", `btoa("√§")`);
    strictEqual(btoa("√•"), "5Q==", `btoa("√•")`);
    strictEqual(btoa("√¶"), "5g==", `btoa("√¶")`);
    strictEqual(btoa("√ß"), "5w==", `btoa("√ß")`);
    strictEqual(btoa("√®"), "6A==", `btoa("√®")`);
    strictEqual(btoa("√©"), "6Q==", `btoa("√©")`);
    strictEqual(btoa("√™"), "6g==", `btoa("√™")`);
    strictEqual(btoa("√´"), "6w==", `btoa("√´")`);
    strictEqual(btoa("√¨"), "7A==", `btoa("√¨")`);
    strictEqual(btoa("√≠"), "7Q==", `btoa("√≠")`);
    strictEqual(btoa("√Æ"), "7g==", `btoa("√Æ")`);
    strictEqual(btoa("√Ø"), "7w==", `btoa("√Ø")`);
    strictEqual(btoa("√∞"), "8A==", `btoa("√∞")`);
    strictEqual(btoa("√±"), "8Q==", `btoa("√±")`);
    strictEqual(btoa("√≤"), "8g==", `btoa("√≤")`);
    strictEqual(btoa("√≥"), "8w==", `btoa("√≥")`);
    strictEqual(btoa("√¥"), "9A==", `btoa("√¥")`);
    strictEqual(btoa("√µ"), "9Q==", `btoa("√µ")`);
    strictEqual(btoa("√∂"), "9g==", `btoa("√∂")`);
    strictEqual(btoa("√∑"), "9w==", `btoa("√∑")`);
    strictEqual(btoa("√∏"), "+A==", `btoa("√∏")`);
    strictEqual(btoa("√π"), "+Q==", `btoa("√π")`);
    strictEqual(btoa("√∫"), "+g==", `btoa("√∫")`);
    strictEqual(btoa("√ª"), "+w==", `btoa("√ª")`);
    strictEqual(btoa("√º"), "/A==", `btoa("√º")`);
    strictEqual(btoa("√Ω"), "/Q==", `btoa("√Ω")`);
    strictEqual(btoa("√æ"), "/g==", `btoa("√æ")`);
    strictEqual(btoa("√ø"), "/w==", `btoa("√ø")`);
  });

  // atob
  t.test('atob', () => {
    strictEqual(atob(""), "", `atob("")`);
    strictEqual(atob("abcd"), 'i¬∑\x1D');
    strictEqual(atob(" abcd"), 'i¬∑\x1D');
    strictEqual(atob("abcd "), 'i¬∑\x1D');
    throws(() => atob(" abcd==="));
    throws(() => atob("abcd=== "));
    throws(() => atob("abcd ==="));
    throws(() => atob("a"));
    strictEqual(atob("ab"), 'i');
    strictEqual(atob("abc"), 'i¬∑');
    throws(() => atob("abcde"));
    throws(() => atob("êÄÄ"));
    throws(() => atob("="));
    throws(() => atob("=="));
    throws(() => atob("==="));
    throws(() => atob("===="));
    throws(() => atob("====="));
    throws(() => atob("a="));
    throws(() => atob("a=="));
    throws(() => atob("a==="));
    throws(() => atob("a===="));
    throws(() => atob("a====="));
    throws(() => atob("ab="));
    strictEqual(atob("ab=="), 'i');
    throws(() => atob("ab==="));
    throws(() => atob("ab===="));
    throws(() => atob("ab====="));
    strictEqual(atob("abc="), 'i¬∑');
    throws(() => atob("abc=="));
    throws(() => atob("abc==="));
    throws(() => atob("abc===="));
    throws(() => atob("abc====="));
    throws(() => atob("abcd="));
    throws(() => atob("abcd=="));
    throws(() => atob("abcd==="));
    throws(() => atob("abcd===="));
    throws(() => atob("abcd====="));
    throws(() => atob("abcde="));
    throws(() => atob("abcde=="));
    throws(() => atob("abcde==="));
    throws(() => atob("abcde===="));
    throws(() => atob("abcde====="));
    throws(() => atob("=a"));
    throws(() => atob("=a="));
    throws(() => atob("a=b"));
    throws(() => atob("a=b="));
    throws(() => atob("ab=c"));
    throws(() => atob("ab=c="));
    throws(() => atob("abc=d"));
    throws(() => atob("abc=d="));
    throws(() => atob("ab\u000Bcd"));
    throws(() => atob("ab\u3000cd"));
    throws(() => atob("ab\u3001cd"));
    strictEqual(atob("ab\tcd"), 'i¬∑\x1D');
    strictEqual(atob("ab\ncd"), 'i¬∑\x1D');
    strictEqual(atob("ab\fcd"), 'i¬∑\x1D');
    strictEqual(atob("ab\rcd"), 'i¬∑\x1D');
    strictEqual(atob("ab cd"), 'i¬∑\x1D');
    throws(() => atob("ab\u00a0cd"));
    strictEqual(atob("ab\t\n\f\r cd"), 'i¬∑\x1D');
    strictEqual(atob(" \t\n\f\r ab\t\n\f\r cd\t\n\f\r "), 'i¬∑\x1D');
    strictEqual(atob("ab\t\n\f\r =\t\n\f\r =\t\n\f\r "), 'i');
    throws(() => atob("A"));
    strictEqual(atob("/A"), '√º');
    strictEqual(atob("//A"), '√ø√∞');
    strictEqual(atob("///A"), '√ø√ø√Ä');
    throws(() => atob("////A"));
    throws(() => atob("/"));
    strictEqual(atob("A/"), '\x03');
    strictEqual(atob("AA/"), '\x00\x0F');
    throws(() => atob("AAAA/"));
    strictEqual(atob("AAA/"), '\x00\x00?');
    throws(() => atob("\u0000nonsense"));
    throws(() => atob("abcd\u0000nonsense"));
    strictEqual(atob("YQ"), 'a');
    strictEqual(atob("YR"), 'a');
    throws(() => atob("~~"));
    throws(() => atob(".."));
    throws(() => atob("--"));
    throws(() => atob("__"));
  });
});
